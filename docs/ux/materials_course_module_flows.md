# Управление материалами: курсы и модули (UX/Flows)

Документ описывает целевую UX-структуру и пользовательские сценарии управления учебными материалами. Адресован дизайнерам и разработчикам для синхронизации ожиданий перед реализацией.

## Роли и доступ
- Управление материалами доступно пользователям с ролью `superadmin`.
- Удаление курсов и модулей требует права `courses.delete`.

## Навигация и маршруты
- Список курсов: `/superadmin/courses`.
- Создание курса: `/superadmin/courses/new`.
- Редактирование курса: `/superadmin/courses/:courseId/edit`.
- Предпросмотр курса: `/superadmin/courses/:courseId/preview`.
- Создание модуля: `/superadmin/courses/:courseId/modules/new`.
- Редактирование модуля: `/superadmin/courses/:courseId/modules/:moduleId/edit`.
- Предпросмотр модуля: `/modules/:moduleId?preview=true`.

## Сценарии

### 1) Материалы → список курсов
- Пользователь открывает `/superadmin/courses` и видит таблицу курсов (название, описание, группа, теги, дата создания, статус «Активен/Черновик»).
- Доступные действия на карточке курса:
  - «Предпросмотр» — открывает курс так, как его видит пользователь.
  - «Редактировать» — переход на страницу редактирования курса.
  - «Выключить/Включить» — переключает активность.
  - «Дублировать» — создаёт копию.
  - «Удалить» — с подтверждением (при наличии права `courses.delete`).
- В шапке списка — кнопка «Создать курс», ведущая на `/superadmin/courses/new`.
- Пустое состояние: подсказка с CTA «Создать курс».

### 2) Создание курса (отдельная страница)
- Поля: Название (обязательно), Описание, Активен, Группа, Теги.
- Дополнительно: опция создать шаблон из двух модулей (теория + тест).
- Кнопки: «Создать», «Отмена» (возврат к списку курсов).
- После успешного создания — автоматический переход на `/superadmin/courses/:courseId/edit`.

### 3) Страница курса (редактирование)
- Хедер с названием, статусом, группой/тегами, кнопками «Сохранить», «Предпросмотр», «Дублировать», «Удалить».
- Раздел «Модули курса»:
  - Кнопка «Создать модуль» ведёт на `/superadmin/courses/:courseId/modules/new`.
  - Список модулей: порядковый номер, тип (Теория/Тест), заголовок, мини-мета (для теста: число вопросов, порог %), действия «Редактировать», «Дублировать», «Удалить».
  - Переупорядочивание модулей — отдельный этап (см. «Технические заметки»).
- Раздел «Вопросы курса» — управление вопросами для всех квиз-модулей (см. сценарий 6).

### 4) Создание модуля (отдельная страница)
- Первый шаг — выбор типа (теория или тест). Форма отличается в зависимости от выбранного типа.
  - Теория: Название, Порядок, Markdown-контент, опциональный видео URL.
  - Тест: Название, Порядок, Порог прохождения, Ожидаемое количество вопросов, Теги.
- Кнопки: «Создать», «Отмена».
- После создания — возврат на страницу редактирования курса.

### 5) Редактирование модуля
- Страница `/superadmin/courses/:courseId/modules/:moduleId/edit`.
- Содержит форму с теми же полями, что при создании.
- После сохранения — возврат на страницу курса.

### 6) Управление вопросами
- На странице курса блок «Вопросы» показывает таблицу: Текст вопроса, Тип (MCQ/Multi), Теги, Последнее обновление, Действия.
- Создание и редактирование вопроса — через форму (модалка/дровер). Поля: Текст, Варианты, Правильные ответы, Объяснение, Теги.
- Действия: «Сохранить», «Удалить» (с подтверждением).

### 7) Дублирование и удаление
- Курс: дублирование создаёт копию со всеми модулями; удаление (с подтверждением) доступно только при наличии права `courses.delete`.
- Модуль: дублирование создаёт копию с увеличенным порядком; удаление — через модальное подтверждение.

### 8) Предпросмотр
- Курс: `/superadmin/courses/:courseId/preview` — просмотр от лица пользователя.
- Модуль: `/modules/:moduleId?preview=true` — без фиксации прогресса.

### 9) Обратная связь и состояния
- Загрузки: скелетон списков/форм, индикаторы на кнопках.
- Пустые состояния: понятные инструкции и CTA.
- Подтверждения для опасных действий (удаление, потеря несохранённых изменений).
- Toast-уведомления об успехах/ошибках и инлайн-валидации форм.

## Технические заметки
- Для переупорядочивания модулей потребуется API `PATCH /superadmin/courses/:courseId/modules/reorder` c телом `{ items: [{ id, orderIndex }] }`.
- Стоит предусмотреть маркер «несохранённые изменения» и guard при уходе со страницы.
- Кнопки удаления должны скрываться, если у пользователя нет `courses.delete`.

## Критерии готовности (MVP)
1. Отдельные страницы создания и редактирования курса/модуля, без инлайн-форм на списках.
2. Пустые состояния, индикаторы загрузки, подтверждения удаления.
3. Предпросмотр курса и модулей (режим без фиксации прогресса).
4. Управление вопросами квизов с валидациями.
5. Базовое переупорядочивание модулей (в минимальном варианте — кнопки вверх/вниз; позже можно добавить DnD).
